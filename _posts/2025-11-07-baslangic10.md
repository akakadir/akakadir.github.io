---
layout: post
title: "nedir? TTL bypass (nonquota)"
categories: [yazılım, genel]
tags: [windows, siyah-şapka, araçlar]
comment_issue_id: 22
---

Tekrardan merhaba, bugün sana operatörlerin pek sevmediği bir konuyu anlatacağım. TTL bypass. Yani telefon operatörlerinin "15GB hotspot, sonrası yaş" dediği sistemin nasıl atlatıldığını. Aslında olay çok basit ama çoğu kişi bunun ne kadar kolay olduğunu bilmiyor. Bir TTL değeri, birkaç komut satırı ve operatörün gözünde sen hala telefonundan internete giriyormuşsun gibi görünüyorsun. Peki bu nasıl oluyor? Gel beraber bakalım.

TTL (Time To Live) aslında bir paketin ağda ne kadar yaşayabileceğini gösteren bir sayıdır. Her cihazdan çıkan paket bir TTL değeriyle başlar. Mesela iPhone'dan çıkan bir paket genellikle TTL=64 ile yola çıkar. Bu paket bir router'dan geçtiğinde TTL bir azalır, yani 63 olur. Bir daha geçerse 62. Böylece paket sonsuz döngüye girmez, bir yerde ölür.

Operatörler bunu çok iyi bilir. Senin telefonundan direkt internete girdiğinde paketlerin TTL=64 olur. Ama telefonunu hotspot yapıp PC'den bağlandığında PC'nin gönderdiği paketler telefon üzerinden geçer ve TTL bir azalır. Yani operatör TTL=63 gördüğünde "ha, bu tethering yapıyor" der ve hotspot kotandan düşer. İşte tüm mesele bu. Operatör Deep Packet Inspection (DPI) denen bir yöntemle trafiğini izler ve TTL değerine bakarak tethering yaptığını anlar.

Peki sen bu sistemi nasıl atlatırsın? Çok basit: PC'nin TTL değerini 65'e ayarlarsın. Böylece paket PC'den çıkarken TTL=65 olur, telefon üzerinden geçerken 64'e düşer ve operatör sanki direkt telefondan internete giriyormuşsun gibi görür.

Windows'ta TTL değerini değiştirmek için netsh komutunu kullanacağız. Regedit ile TTL değişiklerimizi genellikle gömülü şekilde kaydedebiliriz, pek garanti olmadığından koda bunu koymayı mantıklı bulmadım. Ama netsh her zaman çalışır. Ayrıca IPv6'yı devre dışı bırakmak da önemlidir çünkü operatörler IPv6 üzerinden de DPI yapabilir.

tam olarak bunu yapan bir batch script'i aşağıya bıraktım.

```batch
@echo off
net session >nul 2>&1
if %errorLevel% neq 0 (
    powershell -NoProfile -ExecutionPolicy Bypass -Command "Start-Process -FilePath '%~f0' -Verb RunAs"
    exit
)

set "shortcut=%USERPROFILE%\Desktop\bypassTTL.lnk"
set "target=%~f0"
set "icon=C:\Windows\System32\shell32.dll,12"
if not exist "%shortcut%" (
  powershell -NoProfile -ExecutionPolicy Bypass -Command ^
  "$WScriptShell = New-Object -ComObject WScript.Shell; $Shortcut = $WScriptShell.CreateShortcut('%shortcut%'); $Shortcut.TargetPath = '%target%'; $Shortcut.WorkingDirectory = '%~dp0'; $Shortcut.IconLocation = '%icon%'; $Shortcut.Save()"
)

netsh int ipv4 set global defaultcurhoplimit=65 >nul 2>&1

powershell -NoProfile -ExecutionPolicy Bypass -Command "Get-NetAdapterBinding -ComponentID ms_tcpip6 -ErrorAction SilentlyContinue | Disable-NetAdapterBinding -Confirm:$false" >nul 2>&1
```
Bu script'i doğrudan çalıştırmak yerine ana dizin yani “C:\” içinde çalıştırmanı isterim. Çünkü zaten masaüstüne “bypassTTL” adında bir kısayol eklenecek. Windows hazır olduğunda kullanman daha kolay olur. 

Bu yöntem %100 garanti değildir çünkü operatörler sadece TTL'e bakmaz. Bazıları HTTP header'larını, User-Agent bilgilerini, hatta paket boyutlarını bile analiz eder. Mesela bir PC'den yapılan istek ile mobil cihazdan yapılan istek farklı header'lar içerir. Operatör bunu görebilir. Ayrıca bazı operatörler TLS handshake sırasında SNI (Server Name Indication) bilgisine de bakabilir. Yani sadece TTL bypass yeterli olmayabilir.

Fakat çoğu operatör için TTL yeterli bir göstergedir çünkü DPI yapmak maliyetlidir. Her paketi detaylı analiz etmek yerine basitçe TTL'e bakarlar. Bu yüzden TTL bypass genellikle işe yarar.

Bu noktada şunu belirtmeliyim: Operatörün belirlediği kullanım koşullarını aşmak teknik olarak sözleşmeye aykırıdır. Operatör seni fark edebilir, hattını kapatabilir. Ama pratikte bu nadiren olur çünkü operatörler genellikle aşırı kullanımı farketmezler.

Bu yöntem sadece TTL bypass içindir. Başka bir amaçla kötüye kullanılmamalıdır. Asıl amacım burada teknik bir bilgi paylaşmaktır, kimseyi yasaları ihlal etmeye teşvik etmek değil. Her zaman akıllıca kullan.

Bu yazımda sana TTL bypass konusunu anlattım. Neyi nasıl yapacağın senin elinde. Evet, riskli ama kullanışlı.

Başka bir yazıda görüşmek üzere…

Kendine iyi bak, iyi şanslar.
